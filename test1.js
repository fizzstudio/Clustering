var csv2json = require('csvjson-csv2json');
var data = csv2json(s2Data);
var Plotly = require('plotly.js-dist')
/*

var data1 = [{x:1,y:0}, {x:.707,y:.707}, {x:0,y:1}, {x:-.707,y:.707}, {x:-1,y:0},{x:-.707,y:-.707}, {x:0,y:-1}, {x:.707,y:-.707}];
var data2 = [{x:0,y:0}, {x:1,y:1}, {x:2,y:2}, {x:-3,y:3}, {x:4,y:4},{x:5,y:5}, {x:6,y:6}, {x:7,y:7}]
console.log(shoelace(data1));
console.log(shoelace(data2));

*/
var dataWrong = coordinate([
    [
        "232047",
        "522748"
    ],
    [
        "241485",
        "523039"
    ],
    [
        "206219",
        "604081"
    ],
    [
        "160280",
        "493497"
    ],
    [
        "233105",
        "591646"
    ],  
    [
        "116492",
        "509399"
    ],
    [
        "99569",
        "523174"
    ],
    [
        "101553",
        "517715"
    ],
    [
        "146183",
        "622188"
    ],
    [
        "95071",
        "503965"
    ],
    [
        "98675",
        "580608"
    ],
    [
        "127503",
        "623654"
    ],
    [
        "101427",
        "615890"
    ],
    [
        "97430",
        "598804"
    ],
    [
        "93136",
        "613387"
    ],
    [
        "68388",
        "574380"
    ],
    [
        "69565",
        "599820"
    ],
    [
        "67867",
        "545392"
    ]
])

var dataRight = coordinate([
    [
        "665845",
        "557965"
    ],
    [
        "664159",
        "550946"
    ],
    [
        "671919",
        "571761"
    ],
    [
        "657455",
        "567754"
    ],
    [
        "658199",
        "568743"
    ],
    [
        "667639",
        "571164"
    ],
    [
        "667472",
        "570571"
    ],
    [
        "672565",
        "564468"
    ],
    [
        "668502",
        "563937"
    ],
    [
        "656477",
        "573007"
    ],
    [
        "683697",
        "581516"
    ],
    [
        "658103",
        "572250"
    ],
    [
        "647354",
        "579190"
    ],
    [
        "649088",
        "575733"
    ],
    [
        "647103",
        "573853"
    ],
    [
        "658281",
        "582264"
    ],
    [
        "663578",
        "586265"
    ],
    [
        "660327",
        "585901"
    ],
    [
        "641976",
        "577433"
    ],
    [
        "688712",
        "568754"
    ],
    [
        "671269",
        "590258"
    ],
    [
        "641031",
        "593074"
    ],
    [
        "639431",
        "588155"
    ],
    [
        "651740",
        "589474"
    ],
    [
        "634967",
        "579020"
    ],
    [
        "636500",
        "587401"
    ],
    [
        "639394",
        "576728"
    ],
    [
        "673750",
        "594081"
    ],
    [
        "627968",
        "574625"
    ],
    [
        "631297",
        "578351"
    ],
    [
        "627727",
        "578737"
    ],
    [
        "627912",
        "593892"
    ],
    [
        "645171",
        "595209"
    ],
    [
        "624452",
        "584622"
    ],
    [
        "626224",
        "569687"
    ],
    [
        "625728",
        "579460"
    ],
    [
        "631182",
        "565466"
    ],
    [
        "622407",
        "583192"
    ],
    [
        "621726",
        "578003"
    ],
    [
        "620213",
        "574468"
    ],
    [
        "661430",
        "603567"
    ],
    [
        "613545",
        "574733"
    ],
    [
        "618869",
        "577243"
    ],
    [
        "619445",
        "567491"
    ],
    [
        "613191",
        "571942"
    ],
    [
        "614615",
        "574437"
    ],
    [
        "620975",
        "564344"
    ],
    [
        "628080",
        "562986"
    ],
    [
        "631446",
        "561156"
    ],
    [
        "613868",
        "585089"
    ],
    [
        "617910",
        "592293"
    ],
    [
        "614279",
        "599251"
    ],
    [
        "614917",
        "600946"
    ],
    [
        "616060",
        "590779"
    ],
    [
        "609286",
        "586782"
    ],
    [
        "611318",
        "581584"
    ],
    [
        "612184",
        "570393"
    ],
    [
        "629718",
        "558104"
    ],
    [
        "611044",
        "571814"
    ],
    [
        "611581",
        "572630"
    ],
    [
        "625579",
        "551084"
    ],
    [
        "638559",
        "558807"
    ],
    [
        "608557",
        "590278"
    ],
    [
        "610263",
        "574422"
    ],
    [
        "608529",
        "586311"
    ],
    [
        "607214",
        "575069"
    ],
    [
        "606548",
        "574376"
    ],
    [
        "607604",
        "573951"
    ],
    [
        "607911",
        "576556"
    ],
    [
        "606933",
        "576409"
    ],
    [
        "606587",
        "573873"
    ],
    [
        "608298",
        "573748"
    ],
    [
        "606415",
        "581386"
    ],
    [
        "604678",
        "574577"
    ],
    [
        "604737",
        "574591"
    ],
    [
        "604973",
        "574773"
    ],
    [
        "604438",
        "574666"
    ],
    [
        "605250",
        "573272"
    ],
    [
        "605927",
        "572533"
    ],
    [
        "606929",
        "571420"
    ],
    [
        "606809",
        "572101"
    ],
    [
        "606011",
        "569426"
    ],
    [
        "605100",
        "573307"
    ],
    [
        "605913",
        "579526"
    ],
    [
        "605958",
        "573728"
    ],
    [
        "606144",
        "575076"
    ],
    [
        "660650",
        "615038"
    ],
    [
        "658403",
        "611332"
    ],
    [
        "602013",
        "574722"
    ],
    [
        "603145",
        "574795"
    ],
    [
        "600032",
        "575310"
    ],
    [
        "601444",
        "572693"
    ],
    [
        "601182",
        "582584"
    ],
    [
        "605107",
        "563429"
    ],
    [
        "606300",
        "566708"
    ],
    [
        "603849",
        "572396"
    ],
    [
        "604157",
        "574191"
    ],
    [
        "603021",
        "577991"
    ],
    [
        "601376",
        "579831"
    ],
    [
        "604294",
        "574368"
    ],
    [
        "603789",
        "574474"
    ],
    [
        "604067",
        "574091"
    ],
    [
        "601339",
        "571609"
    ],
    [
        "604001",
        "573587"
    ],
    [
        "604352",
        "573425"
    ],
    [
        "604415",
        "571400"
    ],
    [
        "603698",
        "573585"
    ],
    [
        "601900",
        "569391"
    ],
    [
        "604090",
        "574392"
    ],
    [
        "601530",
        "577183"
    ],
    [
        "603855",
        "575180"
    ],
    [
        "611315",
        "560757"
    ],
    [
        "601885",
        "573083"
    ],
    [
        "602667",
        "575857"
    ],
    [
        "617310",
        "551945"
    ],
    [
        "618600",
        "551446"
    ],
    [
        "613871",
        "550423"
    ],
    [
        "637323",
        "549567"
    ],
    [
        "603359",
        "589262"
    ],
    [
        "607084",
        "595500"
    ],
    [
        "598759",
        "582942"
    ],
    [
        "603055",
        "589818"
    ],
    [
        "602887",
        "595245"
    ],
    [
        "599870",
        "591110"
    ],
    [
        "606738",
        "601356"
    ],
    [
        "601967",
        "604428"
    ],
    [
        "600582",
        "599535"
    ],
    [
        "599808",
        "596484"
    ],
    [
        "617717",
        "613939"
    ],
    [
        "600679",
        "599545"
    ],
    [
        "608768",
        "610525"
    ],
    [
        "597620",
        "586226"
    ],
    [
        "596891",
        "579476"
    ],
    [
        "597802",
        "576113"
    ],
    [
        "594029",
        "586701"
    ],
    [
        "597173",
        "575538"
    ],
    [
        "597017",
        "575588"
    ],
    [
        "597428",
        "569940"
    ],
    [
        "597077",
        "568196"
    ],
    [
        "628696",
        "542447"
    ],
    [
        "596481",
        "567449"
    ],
    [
        "610666",
        "551701"
    ],
    [
        "610330",
        "552628"
    ],
    [
        "614943",
        "540976"
    ],
    [
        "632125",
        "541413"
    ],
    [
        "629533",
        "537542"
    ],
    [
        "595193",
        "576508"
    ],
    [
        "593061",
        "579188"
    ],
    [
        "594010",
        "570095"
    ],
    [
        "593840",
        "578685"
    ],
    [
        "593865",
        "572987"
    ],
    [
        "591851",
        "569051"
    ],
    [
        "591484",
        "571087"
    ],
    [
        "592804",
        "584539"
    ],
    [
        "589244",
        "573777"
    ],
    [
        "605284",
        "556134"
    ],
    [
        "597551",
        "556737"
    ],
    [
        "604168",
        "555003"
    ],
    [
        "600039",
        "557139"
    ],
    [
        "585175",
        "574133"
    ],
    [
        "584895",
        "574666"
    ],
    [
        "593398",
        "559764"
    ],
    [
        "589344",
        "563119"
    ],
    [
        "605876",
        "550640"
    ],
    [
        "609030",
        "552436"
    ],
    [
        "597421",
        "554767"
    ],
    [
        "592714",
        "553958"
    ],
    [
        "587466",
        "564953"
    ],
    [
        "612799",
        "537497"
    ],
    [
        "606324",
        "544357"
    ],
    [
        "607269",
        "536961"
    ],
    [
        "602167",
        "543919"
    ],
    [
        "639418",
        "537903"
    ],
    [
        "589180",
        "595099"
    ],
    [
        "588964",
        "597435"
    ],
    [
        "599123",
        "616977"
    ],
    [
        "606111",
        "617846"
    ],
    [
        "589994",
        "610890"
    ],
    [
        "628264",
        "616214"
    ],
    [
        "616561",
        "619007"
    ],
    [
        "598634",
        "619900"
    ],
    [
        "600202",
        "622079"
    ],
    [
        "586097",
        "567445"
    ],
    [
        "588100",
        "557588"
    ],
    [
        "583728",
        "563146"
    ],
    [
        "616044",
        "533807"
    ],
    [
        "636628",
        "533309"
    ],
    [
        "624369",
        "532153"
    ],
    [
        "605850",
        "533310"
    ],
    [
        "616329",
        "529516"
    ],
    [
        "613840",
        "534167"
    ],
    [
        "609796",
        "532982"
    ],
    [
        "600117",
        "539079"
    ],
    [
        "578804",
        "573582"
    ],
    [
        "579712",
        "568354"
    ],
    [
        "579773",
        "568698"
    ],
    [
        "580048",
        "565009"
    ],
    [
        "585195",
        "555011"
    ],
    [
        "577242",
        "574073"
    ],
    [
        "577728",
        "587566"
    ],
    [
        "575440",
        "568511"
    ],
    [
        "597418",
        "538362"
    ],
    [
        "582015",
        "546191"
    ],
    [
        "582057",
        "543124"
    ],
    [
        "582777",
        "542670"
    ],
    [
        "602873",
        "527864"
    ],
    [
        "610980",
        "522819"
    ],
    [
        "601187",
        "531825"
    ],
    [
        "598184",
        "531473"
    ],
    [
        "596179",
        "529556"
    ],
    [
        "593317",
        "534085"
    ],
    [
        "596796",
        "529933"
    ],
    [
        "589112",
        "536573"
    ],
    [
        "649034",
        "528813"
    ],
    [
        "593490",
        "623110"
    ],
    [
        "588597",
        "622592"
    ],
    [
        "593166",
        "622725"
    ],
    [
        "603445",
        "630598"
    ],
    [
        "590583",
        "623314"
    ],
    [
        "594084",
        "629464"
    ],
    [
        "577167",
        "617095"
    ],
    [
        "635690",
        "608046"
    ],
    [
        "595014",
        "632844"
    ],
    [
        "576263",
        "547239"
    ],
    [
        "569197",
        "559307"
    ],
    [
        "569422",
        "567790"
    ],
    [
        "568546",
        "564911"
    ],
    [
        "612485",
        "518009"
    ],
    [
        "568824",
        "570203"
    ],
    [
        "567565",
        "573952"
    ],
    [
        "568570",
        "579335"
    ],
    [
        "567428",
        "580005"
    ],
    [
        "567188",
        "560044"
    ],
    [
        "562704",
        "570596"
    ],
    [
        "571334",
        "594145"
    ],
    [
        "565148",
        "557305"
    ],
    [
        "562920",
        "559223"
    ],
    [
        "563763",
        "559454"
    ],
    [
        "560362",
        "567914"
    ],
    [
        "580561",
        "528916"
    ],
    [
        "620438",
        "511694"
    ],
    [
        "624415",
        "515911"
    ],
    [
        "582176",
        "630383"
    ],
    [
        "578496",
        "631434"
    ],
    [
        "600665",
        "638890"
    ],
    [
        "591823",
        "639096"
    ],
    [
        "597026",
        "642918"
    ],
    [
        "589658",
        "640498"
    ],
    [
        "566609",
        "537592"
    ],
    [
        "565483",
        "551512"
    ],
    [
        "559078",
        "570088"
    ],
    [
        "557378",
        "567033"
    ],
    [
        "558817",
        "576255"
    ],
    [
        "611508",
        "503220"
    ],
    [
        "623004",
        "508050"
    ],
    [
        "551291",
        "576721"
    ],
    [
        "546031",
        "570429"
    ],
    [
        "572029",
        "518313"
    ],
    [
        "583653",
        "652182"
    ],
    [
        "546640",
        "560043"
    ],
    [
        "544056",
        "577786"
    ],
    [
        "551740",
        "588768"
    ],
    [
        "603126",
        "497987"
    ],
    [
        "540029",
        "563888"
    ],
    [
        "533799",
        "564377"
    ],
    [
        "533551",
        "582247"
    ],
    [
        "546632",
        "599204"
    ],
    [
        "525967",
        "565687"
    ],
    [
        "526802",
        "551524"
    ],
    [
        "555429",
        "604551"
    ],
    [
        "553038",
        "606418"
    ],
    [
        "515612",
        "540643"
    ]
])

var data = dataWrong;
function euclidDistance(p, q) {
  //Returns euclidean distance between vectors p and q.
  var sum = 0;
  var i = Math.min(p.length, q.length);

  while (i--) {
    sum += (p[i] - q[i]) * (p[i] - q[i]);
  }

  return Math.sqrt(sum);
};
function coordinate(array){
  var dataArray = [];
  for (let i = 0; i < array.length; i++) {
    dataArray.push({x : array[i][0], y : array[i][1]})
  }
  return dataArray;
}
function shoelace(data){
  let sum = 0;
  let n = data.length;
  for (let i = 0; i < n - 1; i++){
      sum += data[i].x * data[i + 1].y - data[i].y * data[i + 1].x
  }
  sum += data[n - 1].x * data[0].y - data[n - 1].y * data[0].x
  return Math.abs(sum/2);
}

function perimeter(data){
  let sum = 0;
  let n = data.length;
  if (n == 2){
    return euclidDistance([data[0].x, data[0].y], [data[1].x, data[1].y])
  }
  for (let i = 0; i < n - 1; i++){
    let pointer = [data[i].x, data[i].y];
    let next = [data[i + 1].x, data[i + 1].y];
    sum += euclidDistance(pointer, next);
  }
  sum += euclidDistance([data[n-1].x, data[n-1].y], [data[0].x, data[0].y])
  return sum;
}
/*
function flatness(data){
  return 2*Math.sqrt(shoelace(data)*Math.PI)/perimeter(data);
}
  */
let y = [];
let x = [];

for (let point of data){
    x.push(point.x);
    y.push(point.y);
}

shell = convexhull.makeHull(data);

let y2 = [];
let x2 = [];

for (let point of shell){
    x2.push(point.x);
    y2.push(point.y);
}

TESTER2 = document.getElementById('heatmap1');
var trace1 = {
    x: x,
    y: y,
    mode: 'markers',
    type: 'scatter'
};

var trace2 = {
    x: x2,
    y: y2,
    mode: 'lines+markers',
    type: 'scatter'
};
let temp = [trace1, trace2];
Plotly.newPlot(TESTER2, temp);

console.log(perimeter(data));
console.log(data);
//console.log(flatness(convexhull.makeHull(data)));


